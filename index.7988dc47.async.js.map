{"version":3,"sources":["webpack:///./src/index.less","webpack:///./src/layouts/header/index.less","webpack:///./packages/y-indexeddb/index.ts","webpack:///./src/layouts/header/index.tsx","webpack:///./src/index.tsx","webpack:///./src/utils/storage.ts"],"names":["module","exports","IndexedDBSymbol","Symbol","IndexedDB","constructor","symbol","db","dbName","dbVersion","dbStoreName","specifyKey","Error","this","singleInstance","indexedDBInstance","getObjectStore","mode","transaction","sessionStorage","setItem","JSON","stringify","location","reload","console","info","objectStore","open","options","req","window","indexedDB","onupgradeneeded","event","store","currentTarget","result","createObjectStore","keyPath","autoIncrement","createIndex","unique","onsuccess","getDataFromStore","filepath","index","get","addDataFromStore","data","add","deleteDataFromStore","id","target","delete","updateDataFromStore","updateData","allRequest","getAll","allData","dataToUpdate","find","value","put","file","clearDataFromStore","clear","Header","props","theme","onToggleTheme","useState","isShowX","setIsShowX","history","useHistory","useLocation","handleClickTitle","useCallback","push","RouteLink","handleToggleTheme","storage","key","LOCAL_STORAGE_NAME","handleOpenDirectoryOnlyArticle","EventEmitter","EVENT_EMITTER_NAME","goBack","useEffect","className","classnames","style","alignItems","justifyContent","icon","pathname","includes","onClick","faSun","faMoon","memo","library","fas","faFacebookSquare","faYoutubeSquare","faLinkedin","faTwitterSquare","Index","setTheme","handleChangeTheme","html","document","querySelector","setAttribute","localTheme","children","saveLocalStorage","localStorage","log","saveBatchLocalStorage","forEach","item","getLocalStorage","returnType","converter","CONVERT_TYPE_MAP","getItem","clearLocalStorage","removeItem","clearAllLocalStorage","saveSessionStorage","getSessionStorage"],"mappings":"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","file":"index.7988dc47.async.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"content\":\"content___3-pTm\",\"layout\":\"layout___1uzIr\",\"absoluteHorizontalVerticalCenter\":\"absoluteHorizontalVerticalCenter___21_uB\",\"marginHorizontalVerticalCenter\":\"marginHorizontalVerticalCenter___3QJyU\",\"textOverflowEllipsis\":\"textOverflowEllipsis___1wr59\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"header-light\":\"header-light___3cGmx\",\"header-dark\":\"header-dark___pcRuq\",\"header\":\"header___2O2lm\",\"bars\":\"bars___26yCn\",\"title\":\"title___a0WaH\",\"themeIcon\":\"themeIcon___q2Qkx\",\"headerInfo\":\"headerInfo___25wHO\",\"hideBars\":\"hideBars___bkJr0\",\"back\":\"back___FsmmO\",\"hideLeftIcon\":\"hideLeftIcon___L5pJo\",\"navigation\":\"navigation___3mfr-\",\"absoluteHorizontalVerticalCenter\":\"absoluteHorizontalVerticalCenter___2C_vn\",\"marginHorizontalVerticalCenter\":\"marginHorizontalVerticalCenter___scs3c\",\"textOverflowEllipsis\":\"textOverflowEllipsis___PsGMq\"};","type Data = { filepath: string; file: string }\n\nconst IndexedDBSymbol = Symbol()\n\nclass IndexedDB {\n    /* eslint-disable no-use-before-define */\n    static indexedDBInstance: IndexedDB\n    /* eslint-disable no-use-before-define */\n    private db: IDBDatabase\n    private dbName: string\n    private dbVersion: number\n    private dbStoreName: string\n    private specifyKey: string\n\n    constructor(symbol?: symbol) {\n        /**\n         * 以下方法允许开发者即使多次使用 new 也能创建单实例\n         * 坏处是：用户不能创建多实例了，由于这是一个 package\n         * 所以不使用此方法，而是提供 singleInstance 让用户选择单实例或多实例（多次 new）\n         */\n        // if (IndexedDB.indexedDBInstance) {\n        //     return IndexedDB.indexedDBInstance\n        // }\n        // IndexedDB.indexedDBInstance = this\n\n        if (symbol && symbol !== IndexedDBSymbol) {\n            throw new Error('意外的重复初始化 IndexedDB')\n        }\n\n        this.db = null as any\n        this.dbName = ''\n        this.dbVersion = 1\n        this.dbStoreName = ''\n        this.specifyKey = ''\n    }\n\n    static get singleInstance() {\n        if (!this.indexedDBInstance) {\n            this.indexedDBInstance = new IndexedDB(IndexedDBSymbol)\n        }\n\n        return this.indexedDBInstance\n    }\n\n    private getObjectStore(\n        dbStoreName: string,\n        mode: 'readonly' | 'readwrite' | 'versionchange',\n    ) {\n        if (!this.db?.transaction) {\n            sessionStorage.setItem('indexedDB_this', JSON.stringify(this))\n            location.reload()\n            console.info('已尝试刷新页面，查看 session 找错误原因')\n        }\n\n        return this.db?.transaction(dbStoreName, mode)?.objectStore(dbStoreName)\n    }\n\n    // 初始化请求\n    open(options?: {\n        specifyKey?: string // 用来通过此 key 进行 get, delete\n        dbName?: string\n        dbVersion?: number\n        dbStoreName?: string\n    }) {\n        const {\n            specifyKey = 'filepath',\n            dbName = 'yomuaDB',\n            dbVersion = 1,\n            dbStoreName = 'yomua',\n        } = options ?? {}\n\n        this.dbName = dbName\n        this.dbVersion = dbVersion\n        this.dbStoreName = dbStoreName\n        this.specifyKey = specifyKey\n\n        const req = window.indexedDB.open(dbName, dbVersion)\n\n        req.onupgradeneeded = (event: any) => {\n            const store = event?.currentTarget?.result.createObjectStore(\n                dbStoreName,\n                {\n                    keyPath: 'id',\n                    autoIncrement: true,\n                },\n            )\n\n            store.createIndex(this.specifyKey, this.specifyKey, {\n                unique: true,\n            })\n        }\n\n        req.onsuccess = () => {\n            // Better use \"this\" than \"req\" to get the result to avoid problems with garbage collection.\n            // 但是使用 class 方法比较麻烦，这里就直接使用 req.result\n            // db = this.result;\n            this.db = req.result\n\n            // 不能这么做，事务将会在 onsuccess 结束后就被关闭\n            // 参见：https://developer.mozilla.org/zh-CN/docs/Web/API/IndexedDB_API/Using_IndexedDB#%E5%90%91%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%AD%E5%A2%9E%E5%8A%A0%E6%95%B0%E6%8D%AE\n            // this.store = this.getObjectStore(this.dbStoreName, 'readwrite')\n        }\n    }\n\n    getDataFromStore(filepath: string) {\n        if (!filepath) return null as any\n\n        const store = this.getObjectStore(this.dbStoreName, 'readonly')\n        const index = store.index(this.specifyKey)\n\n        return index.get(filepath)\n    }\n\n    addDataFromStore(filepath: string, data: Data) {\n        if (!filepath) return null as any\n\n        const store = this.getObjectStore(this.dbStoreName, 'readwrite')\n\n        return store?.add({\n            ...data,\n            filepath,\n        })\n    }\n\n    deleteDataFromStore(filepath: string) {\n        if (!filepath) return null as any\n\n        const store = this.getObjectStore(this.dbStoreName, 'readwrite')\n\n        const req = store.index(this.specifyKey)\n\n        req.get(filepath).onsuccess = (event: any) => {\n            const id = event?.target?.result?.id\n            store?.delete(id)\n        }\n    }\n\n    updateDataFromStore(filepath: string, updateData: string) {\n        if (!filepath) return null as any\n\n        const store = this.getObjectStore(this.dbStoreName, 'readwrite')\n\n        const allRequest = store.getAll()\n\n        allRequest.onsuccess = (event: any) => {\n            const allData = event?.target?.result || []\n\n            const dataToUpdate = allData.find(\n                (value: Data) => value.filepath === filepath,\n            )\n\n            if (!dataToUpdate) {\n                this.addDataFromStore(filepath, { filepath, file: updateData })\n                return\n            }\n\n            store.put({\n                ...dataToUpdate,\n                file: updateData,\n            })\n        }\n    }\n\n    clearDataFromStore() {\n        const store = this.getObjectStore(this.dbStoreName, 'readwrite')\n        store.clear()\n    }\n}\n\nexport default IndexedDB","import { memo, useCallback, useEffect, useState } from 'react'\nimport { useHistory, useLocation } from 'umi'\nimport classnames from '@yomua/y-classnames'\nimport EventEmitter from '@yomua/y-eventemitter'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faSun, faMoon } from '@fortawesome/free-solid-svg-icons'\n\nimport storage from '@/utils/storage'\nimport { Text, Direction } from '@/component'\nimport {\n    RouteName,\n    RouteLink,\n    EVENT_EMITTER_NAME,\n    LOCAL_STORAGE_NAME,\n} from '@/utils/constant'\n\nimport style from './index.less'\n\ninterface HeaderProps {\n    theme?: Theme\n    onToggleTheme?: (theme: Theme) => void\n}\n\n// const navigationData = [\n//     { id: 'index', label: RouteName.Index, link: RouteLink.Index },\n//     { id: 'type', label: RouteName.Type, link: RouteLink.Type },\n//     { id: 'mood', label: RouteName.Mood, link: RouteLink.Mood },\n//     { id: 'about', label: RouteName.About, link: RouteLink.About },\n// ]\n\nconst Header = (props: HeaderProps) => {\n    const { theme = 'light', onToggleTheme = () => null } = props\n\n    // 显示 [X] 图标\n    const [isShowX, setIsShowX] = useState(false)\n\n    const history = useHistory()\n    const location = useLocation()\n\n    const handleClickTitle = useCallback(() => {\n        history.push(`/${RouteLink.Index}`)\n        setIsShowX(false)\n    }, [])\n\n    const handleToggleTheme = useCallback((theme: Theme) => {\n        return () => {\n            // 将在 @/index 设置主题\n            storage.saveLocalStorage({\n                key: LOCAL_STORAGE_NAME.DATA_THEME,\n                value: theme === 'light' ? 'dark' : 'light',\n            })\n\n            if (theme === 'light') {\n                onToggleTheme('dark')\n                return\n            }\n            onToggleTheme('light')\n        }\n    }, [])\n\n    const handleOpenDirectoryOnlyArticle = useCallback(() => {\n        EventEmitter.emit(EVENT_EMITTER_NAME.SHOW_HEADER_X, !isShowX)\n\n        EventEmitter.emit(EVENT_EMITTER_NAME.OPEN_ARTICLE_DIRECTORY)\n    }, [isShowX])\n\n    const handleBack = useCallback(() => {\n        history.goBack()\n    }, [])\n\n    useEffect(() => {\n        EventEmitter.on(EVENT_EMITTER_NAME.SHOW_HEADER_X, (isShowX) => {\n            setIsShowX(isShowX)\n        })\n\n        return () => {\n            EventEmitter.off(EVENT_EMITTER_NAME.SHOW_HEADER_X)\n        }\n    }, [])\n\n    return (\n        <div className={classnames(style.header, style[`header-${theme}`])}>\n            <Direction\n                alignItems='center'\n                justifyContent='space-between'\n                className={style.headerInfo}\n            >\n                {/* <FontAwesomeIcon\n                    className={classnames(style.back, {\n                        [style.hideLeftIcon]:\n                            location.pathname === `/${RouteLink.Index}`,\n                    })}\n                    icon='chevron-left'\n                    onClick={handleBack}\n                /> */}\n                <FontAwesomeIcon\n                    icon={isShowX ? 'times' : 'bars'}\n                    className={classnames(style.bars, {\n                        [style.hideBars]:\n                            !location.pathname.includes('/feature/article'),\n                    })}\n                    onClick={handleOpenDirectoryOnlyArticle}\n                />\n                <Text className={style.title} onClick={handleClickTitle}>\n                    青芽\n                </Text>\n                <FontAwesomeIcon\n                    className={style.themeIcon}\n                    icon={theme === 'light' ? faSun : faMoon}\n                    onClick={handleToggleTheme(theme)}\n                />\n            </Direction>\n\n            {/* 暂时不需要 Index Type Mood About 这些 */}\n            {/*  <Direction>\n                <Navigation\n                    data={navigationData}\n                    className={style.navigation}\n                />\n            </Direction> */}\n        </div>\n    )\n}\n\nexport default memo(Header)\n","import React, { useCallback, useEffect, useState } from 'react'\nimport { Layout } from 'antd'\nimport { fas } from '@fortawesome/free-solid-svg-icons'\nimport { library } from '@fortawesome/fontawesome-svg-core'\nimport {\n    faLinkedin,\n    faTwitterSquare,\n    faYoutubeSquare,\n    faFacebookSquare,\n} from '@fortawesome/free-brands-svg-icons'\nimport IndexedDB from '~/packages/y-indexeddb'\n\nimport style from './index.less'\nimport Footer from './layouts/footer'\nimport { Sidebar } from './component'\nimport Header from './layouts/header'\nimport storage from './utils/storage'\nimport { ThemeProvider } from './contexts'\nimport { LOCAL_STORAGE_NAME } from './utils/constant'\n\n// 添加 fontawesome 免费版: https://fontawesome.com/search?q=menu&o=r&m=free\nlibrary.add(fas, faFacebookSquare, faYoutubeSquare, faLinkedin, faTwitterSquare)\n\n// 初始化 IndexedDB\nIndexedDB.singleInstance.open({\n    dbVersion: 1,\n    dbName: 'yomuaDB',\n    dbStoreName: 'yomua',\n    specifyKey: 'filepath',\n})\n\nconst Index = (props: { children: React.ReactNode }) => {\n    const [theme, setTheme] = useState<Theme>('light')\n\n    const handleChangeTheme = useCallback((theme: Theme) => {\n        setTheme(theme)\n    }, [])\n\n    useEffect(() => {\n        const html = document.querySelector('html')\n\n        if (!html) {\n            return\n        }\n\n        html.setAttribute(LOCAL_STORAGE_NAME.DATA_THEME, theme)\n    }, [theme])\n\n    // 恢复用户上一次选择的主题\n    useEffect(() => {\n        const localTheme = storage.getLocalStorage<'string', Theme>(\n            LOCAL_STORAGE_NAME.DATA_THEME,\n        )\n\n        if (localTheme) {\n            setTheme(localTheme)\n        }\n    }, [])\n\n    return (\n        <ThemeProvider theme={theme}>\n            <Layout className={style.layout}>\n                <Header theme={theme} onToggleTheme={handleChangeTheme} />\n\n                <Layout.Content className={style.content}>\n                    <Sidebar />\n                    {props.children}\n                </Layout.Content>\n\n                {/* <Footer /> */}\n            </Layout>\n        </ThemeProvider>\n    )\n}\n\nexport default Index\n","import log from './log'\nimport { EnvValueType, JSValueType } from './utils.d'\nimport { CONVERT_TYPE_MAP, LOCAL_STORAGE_NAME } from './constant'\n\ntype StorageDataKey<KeyType> = { key: KeyType; value: string }\n\nconst saveLocalStorage = (\n    data: StorageDataKey<LOCAL_STORAGE_NAME>,\n    // config?,\n) => {\n    const { key, value } = data\n\n    if (!key) {\n        log.error('saveLocalStorage key 不存在', key)\n        return false\n    }\n\n    localStorage.setItem(key, value)\n\n    return true\n}\n\nconst saveBatchLocalStorage = (data: StorageDataKey<LOCAL_STORAGE_NAME>[]) => {\n    data.forEach((item) => {\n        const { key, value } = item ?? {}\n\n        if (!key) {\n            log.error('saveBatchLocalStorage key 不存在: ', key)\n            return false\n        }\n\n        localStorage.setItem(key, value)\n    })\n\n    return true\n}\n\nconst getLocalStorage = <\n    ReturnType extends JSValueType = 'string',\n    DataType = string,\n>(\n    key: LOCAL_STORAGE_NAME,\n    options?: { returnType?: ReturnType },\n): EnvValueType<ReturnType, DataType> => {\n    if (!key) {\n        log.error('getLocalStorage: key 不存在')\n        return '' as EnvValueType<ReturnType, DataType>\n    }\n\n    const { returnType = 'string' } = options ?? {}\n\n    const converter = CONVERT_TYPE_MAP[returnType]\n\n    return converter(localStorage.getItem(key) ?? '') as EnvValueType<\n        ReturnType,\n        DataType\n    >\n}\n\nconst clearLocalStorage = (key: LOCAL_STORAGE_NAME) => {\n    if (!key) {\n        log.warn('clearLocalStorage: key 不存在')\n        return false\n    }\n\n    localStorage.removeItem(key)\n\n    return true\n}\n\nconst clearAllLocalStorage = () => {\n    localStorage.clear()\n    return true\n}\n\nconst saveSessionStorage = (\n    data: StorageDataKey<string>,\n    // config?,\n) => {\n    const { key, value } = data\n\n    if (!key) {\n        log.error('saveSessionStorage: key 不存在')\n        return\n    }\n\n    sessionStorage.setItem(key, value)\n}\n\nconst getSessionStorage = (key: string) => {\n    if (!key) {\n        log.error('getSessionStorage: key 不存在')\n        return ''\n    }\n\n    return sessionStorage.getItem(key) ?? ''\n}\n\nexport default {\n    // localStorage\n    saveLocalStorage,\n    saveBatchLocalStorage,\n    getLocalStorage,\n    clearLocalStorage,\n    clearAllLocalStorage,\n\n    // sessionStorage\n    saveSessionStorage,\n    getSessionStorage,\n}\n"],"sourceRoot":""}