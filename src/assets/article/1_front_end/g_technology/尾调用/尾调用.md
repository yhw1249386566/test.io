# 尾调用

尾调用：A 函数最后一步调用 B 函数。

以下是尾调用：

```js
function f(x){
  return g(x);
}

function f() {
  let m = 1;
  let n = 2;
  return g(m + n);
}
```

以下**不是**尾调用：

```javascript
// 情况一 不是尾调用
function f(x){
  let y = g(x);
  return y;
}

// 情况二 不是尾调用
function f(x){
  return g(x) + 1;
}
```

尾调用优化：有些编译器会针对尾调用进行优化，即：在调用栈（Call Stack）中只保留内层函数的调用记录，释放掉外层函数在栈中的帧。

如果所有函数都是尾调用，那么完全可以做到每次执行时，调用记录只有一项，这将大大节省内存。这就是"尾调用优化"的意义。



# 尾递归

```js
"use strict";

// 注意：目前 Google 以及绝大多数浏览器不支持尾递归优化，原因很多。
// 主要是因为：尾递归优化并不是一个规范，而是一个 JavaScript 引擎的自我隐式实现
// 开发者无法追踪这种优化，也很难控制，并且会失去调用栈。
、、
// 尾递归计算阶乘
function tailRecursiveFactorial(n, accumulator = 1) {
  
  if (n === 0) {
    return accumulator;
  } else {
    return tailRecursiveFactorial(n - 1, n * accumulator);
  }
}

// 调用尾递归函数
const result = tailRecursiveFactorial(99999999);
console.log(result); // 输出：120
```

# 注意

目前 Google 以及绝大多数浏览器不支持尾递归优化，原因很多。

主要是因为：尾递归优化并不是一个规范，而是一个 JavaScript 引擎的自我隐式实现，开发者无法追踪这种优化，也很难控制，并且会失去调用栈。

所以这些浏览器就不实现尾调用优化。
