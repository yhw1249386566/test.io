# 对受控的input组件防抖使得输入时过了防抖毫秒数才显示

## 问题

```react
import _ from 'lodash'

const [value, setValue] = useState('')

function handleChange(value:string) {
  setValue(value)
}

useEffect(()=>{
  // 这里写：当 value 改变时，需要进行的一些副作用（请求）...
  // 但问题是：由于 setValue 被防抖了，所以只有防抖毫秒数过了后，才会更新 value 和显示 value 在 Input 上
},[value])

<Input value={value} onChange={_.debounce(handleChange), 500)} />
```



## 解决方法

```react
import _ from 'lodash'

const [value, setValue] = useState('')
const [valueRefreshToken, setValueRefreshToken] = useState('')

function onMicroValueChange() {
	_.debounce(() =>	setValueRefreshToken(Date.now()), 500Ï)
}

function handleChange(value:string) {
  setValue(value)
  onMicroValueChange()
}

useEffect(()=>{
  // 这里写：当 value 改变时，需要进行的一些副作用（请求）...
},[valueRefreshToken])

<Input value={value} onChange={handleChange}
```

通过以上使得 `valueRefreshToken` 刷新，才去执行副作用的方式，可以使得 Input 组件能及时响应用户的输入，并且同时也能对副作用进行防抖。