# [打标签](https://git-scm.com/book/zh/v2/Git-%E5%9F%BA%E7%A1%80-%E6%89%93%E6%A0%87%E7%AD%BE)

所谓的打标签就是对某一次的提交进行添加一个“备注”，这个备注我们将之称之为：标签。通过该标签我们可以一目了然的知道对应提交的各种信息。

注：通常标签会是当前的版本号，即：更新项目（Repository）并提交后，为该次更新打上指定的版本号；但是这并不是说标签只能是版本号，你可以输入任意字符。

## [列出标签](https://git-scm.com/book/zh/v2/Git-%E5%9F%BA%E7%A1%80-%E6%89%93%E6%A0%87%E7%AD%BE#_%E5%88%97%E5%87%BA%E6%A0%87%E7%AD%BE)

**git tag [-l/-list]：**该命令 Git Repository 中已有的标签，Git 会对列出的标签以字母的顺序排名，虽是如此，但标签列表的顺序排列并不重要。

因为你可以按照特定的模式去查找指定的标签，如：`git tag -l "v1.8.5*"`，该命令显示当前 Repository 中所有匹配 v1.8.5*(通配符，匹配所有字符)系列的标签名

注：按照通配符列出标签需要 `-l` 或 `--list` 选项

如果你只想要完整的标签列表，那么运行 `git tag` 就会默认假定你想要一个列表，它会直接给你列出来， 此时的 `-l` 或 `--list` 是可选的。

然而，如果你提供了一个匹配标签名的通配模式，那么 `-l` 或 `--list` 就是强制使用的。

## [git show](https://git.apachecn.org/#/docs/26)

**git show \<标签>：**将打上指定的标签的提交的信息显示出来，包括但不限于那次提交的修改的内容。

- [轻量标签](https://git-scm.com/book/zh/v2/Git-%E5%9F%BA%E7%A1%80-%E6%89%93%E6%A0%87%E7%AD%BE#_%E8%BD%BB%E9%87%8F%E6%A0%87%E7%AD%BE)不会显示额外的标签信息，只会显示提交（git commit）的信息。

## [创建标签](https://git-scm.com/book/zh/v2/Git-%E5%9F%BA%E7%A1%80-%E6%89%93%E6%A0%87%E7%AD%BE#_%E5%88%9B%E5%BB%BA%E6%A0%87%E7%AD%BE)

Git 支持创建两种标签：

1. **轻量标签（lightweight）**

   轻量标签很像一个不会改变的分支——它只是某个特定提交的引用。

2. **附注标签（annotated）**

   附注标签是存储在 Git 数据库中的一个完整对象， 它们是可以被校验的，其中包含打标签者的名字、电子邮件地址、日期时间，

   此外还有一个标签信息，并且可以使用 GNU Privacy Guard （GPG）签名并验证。

对于创建标签来说，通常会建议创建附注标签，这样你可以拥有以上所有信息；但是如果你只是想用一个临时的标签， 或者因为某些原因不想要保存这些信息，那么也可以用轻量标签。

**创建轻量标签：git tag \<标签>：**为**上一次的提交**打上轻量标签。创建轻量标签不需要使用 `-a`、`-s` 或 `-m` 选项，只需要提供标签名字即可。且当使用 git show \<轻量标签> 命令时，只能查看提交信息，而不会显示额外信息。

**创建附注标签：git tag -a \<标签> [-m "备注信息"]：**为**上一次的提交**打上附注标签，并为之添加备注信息，

其中后面中括号括起来的是可选的，如果不使用中括号中的内容，则 Git 会启动默认的编辑器（笔者这里是 vim）要求你输入备注信息。

若使用 git show \<附注标签> 命令，则能查看额外信息和提交信息，如：打标签者的信息、打标签的日期时间、附注信息和显示具体的提交信息。

## [为指定的提交打上标签](https://git-scm.com/book/zh/v2/Git-%E5%9F%BA%E7%A1%80-%E6%89%93%E6%A0%87%E7%AD%BE#_%E5%90%8E%E6%9C%9F%E6%89%93%E6%A0%87%E7%AD%BE)

**git tag -a \<标签> \<完整校验和/部分校验和> [-m "备注信息"]：**为指定的提交打上附注标签并写上备注信息。

你可以使用 git log --pretty --oneline命令显示出所有简略（的文件校验和）提交信息（git log --pretty=oneline 显示完整的文件校验和），接着使用 git tag -a \<标签> \<完整校验和/部分校验和> [-m "备注信息"]命令为指定的提交打上附注标签并写上备注信息。

若中括号中的内容不选，则 Git 会启动默认编辑器，让你输入备注信息（通常是必须的，不过你可以通过某些命令不输入，但不建议，所以我这里不提怎么做）

## 共享标签

所谓的共享标签就是把自己为本地仓库创建的标签，推送到该本地仓库服务器上面。

因为默认情况下，使用 `git push` 命令推送信息到远程仓库，并不会也将标签传送到远程仓库服务器上。

所以在创建完标签后你必须显式地推送标签到共享服务器上，其操作和将分支推送（共享）到远程仓库一样*（详见：Git 远程仓库的基本使用 - 推送分支到远程仓库）*，使用的命令为：

`git push <remote>(如：origin) <tagname>`：该命令将指定的 \<tagname> 推送/共享到简写名为 origin 的远程仓库中。

若你想要一次共享多个标签，则使用带有 --tags 选项的 git push 名，如：

`git push <remote>(如：origin) --tags`：把所有不在远程仓库服务器上对应的 origin 本地仓库的标签全部传送到远程仓库中。

若执行以上两个名字，当其他人从仓库中克隆或拉取，他们也能得到你的那些标签。

笔者注：`git push` 推送两种标签。使用 `git push <remote> --tags` 推送的标签并不会区分轻量标签和附注标签， 要知道，没有简单的选项能够让你只选择推送一种标签。

## [删除标签](https://git-scm.com/book/zh/v2/Git-%E5%9F%BA%E7%A1%80-%E6%89%93%E6%A0%87%E7%AD%BE#_%E5%88%A0%E9%99%A4%E6%A0%87%E7%AD%BE)

`git tag -d <tagname>`：删除当前仓库中，指定的本地标签。

注：以上命令，并不会从任何远程仓库中删除指定的标签，而只是删除本地标签，若想要删除远程仓库中的指定标签，则有两种方式：

1. `git push <remote> :refs/tags/<tagname>`

   通过将远程仓库指定的标签更新成空白，从而移除标签。

   即：将冒号前面的空值推送到远程标签名，从而高效地删除它。

2. `git push <remote> --delete <tagname>`

   第二种方式更直观的移除远程仓库的标签

## [检出（切换）标签](https://git-scm.com/book/zh/v2/Git-%E5%9F%BA%E7%A1%80-%E6%89%93%E6%A0%87%E7%AD%BE#_%E6%A3%80%E5%87%BA%E6%A0%87%E7%AD%BE)（有关分离头指针状态）

git checkout：切换分支或恢复工作树文件

如果你想查看某个标签所指向的文件版本，可以使用 `git checkout <tagname>` 命令， 虽然这会使你的仓库处于“分离头指针（detached HEAD）”的状态。

这个状态有些不好的副作用：在“分离头指针”状态下，如果你做了某些更改然后提交它们，标签不会发生变化，且你的新提交将不属于任何分支，并且将无法访问，除非通过确切的提交哈希才能访问。

- 注：HEAD 指向一个没有分支名字的 Git Repository 中的某次提交时的项目版本，这种情况下，就叫做：“分离头（detached HEAD）”

因此，如果你处于“分离头指针”状态，且在该状态下需要进行 Repository 中的更改，比如你要修复旧版本中的错误，那么通常需要创建一个新分支。

`git checkout <tagname>`：切换到指定的标签的项目版本，并且进入“分离头指针”状态。

若你处在一个标签的“分离头指针”状态中，你将获得“分离头指针”状态的所有副作用，因此你可以使用 `git checkout -b <NewBrachname> <tagname>` 命令基于 \<tagname> 分支版本创建一个 \<NewBrachname> 新分支，并切换过去。（PS：实际上笔者并不知道对不对，不过有个章节和该命令很像，*详见：Git 分支 - 远程分支*）

若你在这新分支中修改了内容并提交，那么这新分支就会因为这个改动向前移动， 此时它就会和 \<tagname> 稍微有些不同，这时就要当心了。

使用  `git checkout -b <NewBrachname> <tagname>` 命令创建的新分支，在使用 git log 命令时，\<NewBrachname> 将会显示在 \<tagname> 后，且使用 git tag（列出当前 Repository 的所有标签）

```bash
$ git checkout -b version v1.2
$ git log
commit b5a539446b5fbd4d9f9937afbebeb38ca62277f8 (tag: v1.2, version2)
Author: Yomua <yomua.yhw@gmail.com>
Date:   Sat Jul 11 15:54:16 2020 +0800

    deleter demo.md 1th
```

